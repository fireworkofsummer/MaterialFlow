<view class="container">
  <!-- æœç´¢å’Œç­›é€‰ -->
  <view class="search-section">
    <view class="search-bar">
      <input
        class="search-input"
        placeholder="æœç´¢ç‰©æ–™åç§°ã€è§„æ ¼..."
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
      />
    </view>
    
    <picker
      mode="selector"
      range="{{categories}}"
      value="{{categories.indexOf(selectedCategory)}}"
      bindchange="onCategoryChange"
    >
      <view class="category-picker">
        åˆ†ç±»: {{selectedCategory === 'all' ? 'å…¨éƒ¨' : selectedCategory}}
      </view>
    </picker>
  </view>

  <!-- ç‰©æ–™åˆ—è¡¨ -->
  <view class="materials-list" wx:if="{{filteredMaterials.length > 0}}">
    <view 
      class="material-item {{item.isLowStock ? 'low-stock' : ''}}"
      wx:for="{{filteredMaterials}}" 
      wx:key="id"
    >
      <!-- ä¸»è¦ä¿¡æ¯ -->
      <view class="material-main" bindtap="onViewDetail" data-id="{{item.id}}">
        <view class="material-header">
          <view class="material-name">{{item.name}}</view>
          <view class="stock-badge" wx:if="{{item.isLowStock}}">
            <text class="warning-icon">âš ï¸</text>
            åº“å­˜ä¸è¶³
          </view>
        </view>
        
        <view class="material-spec">{{item.specification}}</view>
        
        <view class="material-stats">
          <view class="stat-item">
            <text class="stat-label">å½“å‰åº“å­˜</text>
            <text class="stat-value {{item.isLowStock ? 'text-warning' : ''}}">
              {{item.currentStock}}{{item.unit}}
            </text>
          </view>
          <view class="stat-item">
            <text class="stat-label">åº“å­˜ä»·å€¼</text>
            <text class="stat-value">Â¥{{item.currentValueFormatted}}</text>
          </view>
          <view class="stat-item" wx:if="{{item.minStockAlert}}">
            <text class="stat-label">é¢„è­¦çº¿</text>
            <text class="stat-value">{{item.minStockAlert}}{{item.unit}}</text>
          </view>
        </view>
      </view>
      
      <!-- æ“ä½œæŒ‰é’® -->
      <view class="material-actions">
        <view class="action-btn-small" bindtap="onQuickInbound" data-id="{{item.id}}">
          å…¥åº“
        </view>
        <view 
          class="action-btn-small {{item.currentStock <= 0 ? 'disabled' : ''}}" 
          bindtap="onQuickOutbound" 
          data-id="{{item.id}}"
        >
          å‡ºåº“
        </view>
        <view class="action-btn-small" bindtap="onEditMaterial" data-id="{{item.id}}">
          ç¼–è¾‘
        </view>
        <view class="action-btn-small danger" bindtap="onDeleteMaterial" data-id="{{item.id}}">
          åˆ é™¤
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <view class="empty-icon">ğŸ“¦</view>
    <view class="empty-text">æš‚æ— ç‰©æ–™æ•°æ®</view>
    <view class="btn-primary" bindtap="onAddMaterial">æ·»åŠ ç¬¬ä¸€ä¸ªç‰©æ–™</view>
  </view>

  <!-- æ·»åŠ æŒ‰é’® -->
  <view class="fab" bindtap="onAddMaterial" wx:if="{{filteredMaterials.length > 0}}">
    <text class="fab-icon">+</text>
  </view>
</view>
